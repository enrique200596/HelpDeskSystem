@page "/ayuda"
@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider

<PageTitle>Centro de Ayuda | HelpDesk</PageTitle>

<div class="container py-4">
    <div class="text-center mb-5">
        <h1 class="fw-bold text-dark"><i class="bi bi-life-preserver text-danger me-2"></i>Centro de Ayuda</h1>
        <p class="text-muted lead">Guías operativas según tu rol en el sistema.</p>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-10">

            @* --- ROL: ADMINISTRADOR --- *@
            <AuthorizeView Roles="Administrador">
                <div class="card shadow-sm mb-4 border-0">
                    <div class="card-header bg-dark text-white py-3">
                        <h5 class="mb-0"><i class="bi bi-shield-lock-fill me-2"></i>Funciones de Administrador</h5>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="accordionAdmin">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#adm1">
                                        <i class="bi bi-people-fill me-2"></i> 1. Gestión de Usuarios
                                    </button>
                                </h2>
                                <div id="adm1" class="accordion-collapse collapse show" data-bs-parent="#accordionAdmin">
                                    <div class="accordion-body">
                                        Ve a <strong>Gestión de Usuarios</strong> para:
                                        <ul>
                                            <li><strong>Crear:</strong> Registrar nuevos Asesores o Usuarios con correo y contraseña.</li>
                                            <li><strong>Editar:</strong> Modificar datos básicos o roles.</li>
                                            <li><strong>Dar de Baja:</strong> Desactivar el acceso (checkbox "Activo") sin borrar el historial.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#adm2">
                                        <i class="bi bi-award-fill me-2"></i> 2. Asignar Especialidades
                                    </button>
                                </h2>
                                <div id="adm2" class="accordion-collapse collapse" data-bs-parent="#accordionAdmin">
                                    <div class="accordion-body">
                                        Para que un Asesor reciba tickets, debes asignarle categorías (ej. "Sistemas", "Hardware").
                                        <br />
                                        Ve a <strong>Asignar Especialidades</strong> > Selecciona el Asesor > Marca sus áreas > Guardar.
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#adm3">
                                        <i class="bi bi-bar-chart-fill me-2"></i> 3. Reportes Gerenciales
                                    </button>
                                </h2>
                                <div id="adm3" class="accordion-collapse collapse" data-bs-parent="#accordionAdmin">
                                    <div class="accordion-body">
                                        Accede a <strong>Reportes</strong> para ver KPIs en tiempo real:
                                        <ul>
                                            <li><strong>Tiempo Promedio:</strong> Horas que tardan los asesores en resolver casos.</li>
                                            <li><strong>Volumen:</strong> Cantidad de tickets por categoría.</li>
                                            <li><strong>Filtros:</strong> Puedes filtrar la data por fecha y por asesor específico.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </AuthorizeView>

            @* --- ROL: ASESOR --- *@
            <AuthorizeView Roles="Asesor">
                <div class="card shadow-sm mb-4 border-0">
                    <div class="card-header bg-warning text-dark py-3">
                        <h5 class="mb-0"><i class="bi bi-headset me-2"></i>Funciones de Asesor</h5>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="accordionAsesor">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#ase1">
                                        1. Auto-asignación de Tickets
                                    </button>
                                </h2>
                                <div id="ase1" class="accordion-collapse collapse show" data-bs-parent="#accordionAsesor">
                                    <div class="accordion-body">
                                        Tu tablero muestra tickets de tus categorías que nadie ha tomado.
                                        <ol>
                                            <li>Abre el ticket pendiente.</li>
                                            <li>Haz clic en el botón amarillo <strong>"Tomar Caso"</strong>.</li>
                                            <li>El ticket se asignará a tu nombre y desaparecerá del tablero de otros asesores.</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#ase2">
                                        2. Gestión del Chat
                                    </button>
                                </h2>
                                <div id="ase2" class="accordion-collapse collapse" data-bs-parent="#accordionAsesor">
                                    <div class="accordion-body">
                                        Una vez asignado, se habilita el chat con el usuario.
                                        <ul>
                                            <li>Envía mensajes de texto para dar soporte.</li>
                                            <li>Usa el icono de <strong>Clip</strong> para adjuntar imágenes o PDFs (Máx 5MB).</li>
                                            <li>Recibirás una notificación sonora si el usuario responde mientras estás en otra pantalla.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#ase3">
                                        3. Cerrar el Ticket
                                    </button>
                                </h2>
                                <div id="ase3" class="accordion-collapse collapse" data-bs-parent="#accordionAsesor">
                                    <div class="accordion-body">
                                        Cuando el problema esté resuelto, presiona el botón verde <strong>"Finalizar"</strong>.
                                        Esto bloqueará el chat y solicitará al usuario que califique tu atención.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </AuthorizeView>

            @* --- ROL: USUARIO --- *@
            <AuthorizeView Roles="Usuario">
                <div class="card shadow-sm mb-4 border-0">
                    <div class="card-header bg-primary text-white py-3">
                        <h5 class="mb-0"><i class="bi bi-person-badge me-2"></i>Funciones de Usuario</h5>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="accordionUser">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#usr1">
                                        1. Solicitar Soporte
                                    </button>
                                </h2>
                                <div id="usr1" class="accordion-collapse collapse show" data-bs-parent="#accordionUser">
                                    <div class="accordion-body">
                                        Usa el botón <strong>"Nuevo Ticket"</strong>. Completa el título, selecciona la categoría (ej. Finanzas) y detalla tu problema.
                                        Si es una emergencia real, marca la casilla "Urgente" para que aparezca con borde rojo a los asesores.
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#usr2">
                                        2. ¿Cuándo puedo chatear?
                                    </button>
                                </h2>
                                <div id="usr2" class="accordion-collapse collapse" data-bs-parent="#accordionUser">
                                    <div class="accordion-body">
                                        Al crear el ticket, el chat estará en modo <strong>"Esperando asesor..."</strong>.
                                        No podrás escribir hasta que un asesor tome tu caso. En ese momento, el sistema te avisará con un sonido y el chat se desbloqueará automáticamente.
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#usr3">
                                        3. Calificar Atención
                                    </button>
                                </h2>
                                <div id="usr3" class="accordion-collapse collapse" data-bs-parent="#accordionUser">
                                    <div class="accordion-body">
                                        Cuando el asesor finalice el ticket, aparecerán 5 estrellas en la parte superior.
                                        Selecciona una calificación para cerrar el proceso. Esto nos ayuda a mejorar.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </AuthorizeView>

        </div>
    </div>
</div>

@code {
}